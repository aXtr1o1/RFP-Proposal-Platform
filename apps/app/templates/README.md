# Template System Documentation

This directory contains PowerPoint presentation templates for the PPT generation system.

## Template Structure (Native PPTX Mode)

Each template directory follows this structure:

```
templates/{template_id}/
├── template.pptx          # Native PPTX with master slides and layouts (REQUIRED)
├── manifest.json          # Auto-generated from template.pptx analysis
├── config.json            # Template metadata and settings
├── Background/            # Optional background images for overlay
│   ├── bg_content.png
│   ├── bg_section.png
│   └── ...
├── theme.json             # Optional theme colors and fonts
└── constraints.json       # Optional layout constraints
```

## Key Files

### template.pptx
The native PowerPoint template containing master slides and layouts. This is the primary source for layout definitions.

**Required Layouts:**
- 0: Title Slide
- 1: Title and Content
- 2: Section Header
- 3: Two Content
- 4: Comparison
- 5: Title Only
- 6: Blank

### manifest.json
Auto-generated by the template analyzer. Contains extracted layout information:
- Placeholder positions and types
- Layout metadata
- Content type mappings
- Theme colors and fonts

**To regenerate:**
```bash
python generate_manifests.py
```

### config.json
Template configuration including:
- `template_id`: Unique identifier
- `template_mode`: Should be "native"
- `language_settings`: RTL/LTR and font settings per language
- `layout_mapping`: Content type to layout index mapping
- `background_images`: Optional background image paths per layout type
- `page_numbering`: Page number styling and position

## Creating a New Template

1. **Create template.pptx** in PowerPoint with desired master slides and layouts
2. **Copy to templates directory** as `templates/{template_id}/template.pptx`
3. **Create config.json** with template settings
4. **Run analyzer** to generate manifest.json:
   ```bash
   python generate_manifests.py
   ```
5. **Add background images** (optional) to the `Background/` folder

## Supported Content Types

| Content Type | Description | Default Layout |
|-------------|-------------|----------------|
| title | Title slide | Title Slide (0) |
| section | Section header | Section Header (2) |
| content | General content | Title and Content (1) |
| bullets | Bullet points | Title and Content (1) |
| paragraph | Paragraph text | Title and Content (1) |
| table | Data table | Title and Content (1) |
| chart | Chart/graph | Title and Content (1) |
| two_column | Two-column layout | Two Content (3) |
| comparison | Comparison layout | Comparison (4) |
| blank | Blank slide | Blank (6) |

## Language Support

Templates support multiple languages with RTL/LTR configuration:

```json
{
  "language_settings": {
    "default": "en",
    "supported": ["ar", "en"],
    "ar": {
      "rtl": true,
      "alignment": "right",
      "default_font": "Tajawal",
      "heading_font": "Cairo"
    },
    "en": {
      "rtl": false,
      "alignment": "left",
      "default_font": "Open Sans",
      "heading_font": "Roboto"
    }
  }
}
```

## Migration from JSON Mode

The system previously supported a `json_only` mode with `layouts.json` for element positioning. This has been deprecated in favor of native PPTX templates which provide:

- **Better editability**: Generated slides are fully editable in PowerPoint
- **Consistent formatting**: Styles come from the template, not code
- **Simpler configuration**: No need to define positions in JSON
- **Template flexibility**: Designers can modify PPTX templates directly
- **Better RTL support**: PowerPoint handles RTL in placeholders natively

If you have old templates using `layouts.json`, create a proper `template.pptx` with master slides and run the analyzer to generate a manifest.
